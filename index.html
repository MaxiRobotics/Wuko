touch package.json
nano package.json

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <title>Wuko - Viral Thread Studio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        fontFamily: {
          'sans': ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'sans-serif'],
          'display': ['Manrope', 'Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'sans-serif'],
        },
        extend: {
          colors: {
            navy: {
              DEFAULT: '#0D0D1F',
              light: '#14142A',
              dark: '#09091A',
              accent: '#1F1F3D'
            },
            orange: {
              DEFAULT: '#FFA500',
              light: '#FFB733',
              dark: '#E69500',
              glow: '#FFA50033'
            },
            neon: {
              green: '#5CD5B0',
              pink: '#FF5CB8',
              blue: '#5C9EFF',
              purple: '#8855FF'
            },
            offwhite: {
              DEFAULT: '#F5F5F5',
              dark: '#E5E5E5',
              darker: '#CCCCCC'
            }
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'float': 'float 4s ease-in-out infinite',
            'spin-slow': 'spin 8s linear infinite',
            'wiggle': 'wiggle 1s ease-in-out infinite',
            'glow': 'glow 2s ease-in-out infinite',
            'bounce-short': 'bounce-short 2s ease-in-out infinite',
            'slide-up': 'slide-up 0.5s ease-out',
            'expand': 'expand 0.4s ease-out',
            'steam': 'steam 3s ease-in-out infinite',
            'ripple': 'ripple 0.7s ease-out'
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' }
            },
            'bounce-short': {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-5px)' }
            },
            glow: {
              '0%, 100%': { boxShadow: '0 0 5px rgba(255, 165, 0, 0.5)' },
              '50%': { boxShadow: '0 0 20px rgba(255, 165, 0, 0.7)' }
            },
            wiggle: {
              '0%, 100%': { transform: 'rotate(-3deg)' },
              '50%': { transform: 'rotate(3deg)' }
            },
            'slide-up': {
              '0%': { transform: 'translateY(20px)', opacity: 0 },
              '100%': { transform: 'translateY(0)', opacity: 1 }
            },
            expand: {
              '0%': { transform: 'scale(0.95)', opacity: 0 },
              '100%': { transform: 'scale(1)', opacity: 1 }
            },
            steam: {
              '0%': { transform: 'translateY(0) scale(1)', opacity: 0.8 },
              '100%': { transform: 'translateY(-20px) scale(1.5)', opacity: 0 }
            },
            ripple: {
              '0%': { transform: 'scale(0.8)', opacity: 1 },
              '100%': { transform: 'scale(2.5)', opacity: 0 }
            }
          },
          boxShadow: {
            'orange-glow': '0 0 15px rgba(255, 165, 0, 0.7)',
            'inset-dark': 'inset 0 2px 10px rgba(0, 0, 0, 0.3)',
            'glass': '0 8px 32px rgba(0, 0, 0, 0.2)',
            'glass-sm': '0 4px 20px rgba(0, 0, 0, 0.15)',
            'highlight': 'inset 0 1px 0 0 rgba(255, 255, 255, 0.05)'
          },
          backgroundImage: {
            'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
            'noise': "url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIj4KPGZpbHRlciBpZD0iYSIgeD0iMCIgeT0iMCI+CjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIuNzUiIHN0aXRjaFRpbGVzPSJzdGl0Y2giLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ic2F0dXJhdGUiIHZhbHVlcz0iMCIvPgo8L2ZpbHRlcj4KPHBhdGggZmlsdGVyPSJ1cmwoI2EpIiBvcGFjaXR5PSIuMDUiIGQ9Ik0wIDBoMzAwdjMwMEgweiIvPgo8L3N2Zz4=')"
          },
          transitionProperty: {
            'height': 'height',
            'spacing': 'margin, padding',
          }
        }
      }
    }
  </script>
  <style>
    body {
      background-color: #0D0D1F;
      background-image: 
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"),
        radial-gradient(circle at 10% 20%, rgba(30, 30, 60, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 90% 80%, rgba(30, 30, 60, 0.3) 0%, transparent 50%);
      color: #F5F5F5;
      min-height: 100vh;
      font-family: 'Inter', sans-serif;
    }
    
    /* Glassmorphism */
    .glass {
      background: rgba(20, 20, 42, 0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);
    }
    
    /* Custom Scrollbar */
    .custom-scrollbar::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background-color: rgba(255, 165, 0, 0.5);
      border-radius: 10px;
    }
    
    /* Glowing effect */
    .glow-hover:hover {
      box-shadow: 0 0 15px rgba(255, 165, 0, 0.8);
    }
    
    /* Orange underline animation */
    .animated-underline {
      position: relative;
      display: inline-block;
    }
    .animated-underline::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -2px;
      left: 0;
      background-color: #FFA500;
      transition: width 0.3s ease;
    }
    .animated-underline:hover::after {
      width: 100%;
    }
    
    /* Toggle switch */
    .toggle-checkbox:checked {
      right: 0;
      border-color: #0D0D1F;
      background-color: #FFA500;
    }
    .toggle-checkbox:checked + .toggle-label {
      background-color: rgba(255, 165, 0, 0.3);
    }
    
    /* Floating animation for background elements */
    @keyframes floatElement {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(-10px) rotate(1deg); }
      50% { transform: translateY(0) rotate(0deg); }
      75% { transform: translateY(10px) rotate(-1deg); }
    }
    
    .float-element {
      animation: floatElement 10s ease-in-out infinite;
      position: absolute;
      opacity: 0.03;
      z-index: -1;
    }
    
    /* Macaque container */
    .macaque-container {
      position: fixed;
      right: 20px;
      bottom: 20px;
      z-index: 50;
      width: 120px;
      height: 120px;
    }
    
    /* Experience bar */
    .exp-bar {
      height: 4px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .exp-fill {
      height: 100%;
      background-color: #FFA500;
      transition: width 0.8s ease-out;
    }
    
    /* Speech bubble */
    .speech-bubble {
      position: absolute;
      background: rgba(20, 20, 42, 0.9);
      border-radius: 12px;
      padding: 12px;
      width: 220px;
      max-width: 220px;
      top: -90px;
      right: 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      transition: opacity 0.3s, transform 0.3s;
      transform-origin: bottom right;
    }
    
    .speech-bubble:after {
      content: '';
      position: absolute;
      bottom: -7px;
      right: 20px;
      width: 15px;
      height: 15px;
      background: rgba(20, 20, 42, 0.9);
      transform: rotate(45deg);
    }
    
    /* Sparkle animation for small floating stars */
    .sparkle {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background-color: #FFA500;
      opacity: 0;
      animation: sparkle 3s linear infinite;
    }
    
    @keyframes sparkle {
      0% { opacity: 0; transform: scale(0); }
      20% { opacity: 0.8; transform: scale(1); }
      40% { opacity: 0; transform: scale(0); }
      100% { opacity: 0; }
    }
    
    /* Typewriter effect for hero text */
    .typewriter {
      overflow: hidden;
      border-right: 2px solid #FFA500;
      white-space: nowrap;
      margin: 0 auto;
      animation: 
        typing 3.5s steps(40, end),
        blink-caret .75s step-end infinite;
    }
    
    @keyframes typing {
      from { width: 0 }
      to { width: 100% }
    }
    
    @keyframes blink-caret {
      from, to { border-color: transparent }
      50% { border-color: #FFA500 }
    }
    
    /* Blinking animation for macaque eyes */
    @keyframes blink {
      0%, 45%, 55%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(0.1); }
    }
    
    .animate-blink {
      animation: blink 4s infinite;
      animation-delay: calc(var(--delay, 0) * 1s);
      transform-origin: center;
    }
  </style>
</head>
<body>
  <!-- Background animated elements -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <!-- Animated background shapes -->
    <div class="absolute inset-0 bg-noise opacity-5"></div>
    
    <!-- Gradient blobs that subtly move in background -->
    <div class="absolute opacity-10 w-[800px] h-[800px] rounded-full bg-gradient-to-r from-neon-blue/20 to-neon-purple/20 blur-3xl -top-[400px] -left-[400px] animate-spin-slow"></div>
    <div class="absolute opacity-10 w-[600px] h-[600px] rounded-full bg-gradient-to-r from-orange/20 to-neon-pink/20 blur-3xl bottom-[0px] -right-[300px] animate-spin-slow" style="animation-delay: -4s; animation-duration: 12s;"></div>
    
    <!-- Floating subtle elements -->
    <div class="absolute top-1/4 left-1/5 w-8 h-8 text-3xl animate-float opacity-5">✱</div>
    <div class="absolute top-2/3 right-1/5 w-8 h-8 text-3xl animate-float opacity-5" style="animation-delay: -2s;">✴</div>
    <div class="absolute top-1/2 left-1/3 w-8 h-8 text-3xl animate-float opacity-5" style="animation-delay: -3s;">✺</div>
    
    <!-- Steam particles for ambient effect -->
    <div id="steam-container" class="absolute bottom-20 right-20 z-10 pointer-events-none"></div>
    
    <!-- Random sparkles -->
    <div id="sparkle-container"></div>


  </div>

  <div class="container mx-auto px-4 py-6 max-w-6xl relative flex flex-col items-center justify-center">
    <header class="mb-10 text-center relative max-w-[700px] mx-auto animate-slide-up">
      <!-- Logo and title -->
      <div class="flex items-center justify-center space-x-3 mb-3 relative">
        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-orange to-orange-light flex items-center justify-center text-navy-dark font-bold shadow-orange-glow animate-bounce-short relative overflow-hidden">
          <img src="https://pfst.cf2.poecdn.net/base/image/d5eeb60da99b0f5da5b372b289a1c7b3323b8a790cd0245bb3b5248b87f75ac9?w=1024&h=1024" class="w-10 h-10 object-cover" alt="Wuko Macaque">
          <!-- Animated steam effect -->
          <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 opacity-70 animate-float">
            <span class="animate-steam absolute">☁️</span>
            <span class="animate-steam absolute" style="animation-delay: 1.5s; left: 4px;">☁️</span>
          </div>
        </div>
        <div>
          <h1 class="text-3xl font-display font-bold bg-clip-text text-transparent bg-gradient-to-r from-orange to-orange-light glow-hover">Wuko</h1>
          <div class="h-0.5 w-32 bg-gradient-to-r from-orange/50 to-transparent mx-auto mt-1"></div>
        </div>
      </div>
      
      <!-- Animated hero message -->
      <div class="h-10 flex justify-center items-center overflow-hidden mt-3">
        <p id="hero-message" class="text-xl font-medium text-offwhite opacity-80 typewriter">Scribbles in. Gold out.</p>
      </div>
      
      <!-- Monkey wisdom (fortune cookie style) -->
      <div class="mt-3 mx-auto max-w-md">
        <div class="flex items-center justify-center bg-navy-accent rounded-full px-4 py-1.5 shadow-glass-sm">
          <div class="text-xs text-orange mr-2">🧠</div>
          <span id="monkey-fact" class="text-xs text-gray-300 italic cursor-help font-light text-blue-200/80" title="Click for a new wisdom">Wuko Wisdom: A macaque once typed Hamlet... took 3 million years. You're faster.</span>
        </div>
      </div>
    </header>

    <!-- Main content wrapper with centered layout -->
    <div class="max-w-[700px] mx-auto mt-8 animate-slide-up">
      <!-- Content input section - now directly below the header -->
      <div class="glass rounded-xl p-5 mb-6 shadow-glass relative overflow-hidden group">
        <!-- Subtle glow effect that moves with input focus -->
        <div id="input-glow" class="absolute -inset-1 bg-gradient-to-r from-orange/0 via-orange/0 to-orange/0 blur opacity-0 group-hover:opacity-10 transition-opacity duration-500"></div>
        
        <div class="flex justify-between items-center mb-3">
          <label for="content" class="flex items-center text-sm font-medium text-offwhite">
            <span class="mr-2">Your Long-Form Content</span>
            <span class="text-xs text-gray-400 font-normal">(555 words max)</span>
          </label>
          
          <div class="text-xs text-offwhite flex items-center gap-2">
            <button id="paste-btn" class="text-orange hover:text-orange-light px-2 py-1 rounded-md transition-colors flex items-center gap-1">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
              Paste
            </button>
          </div>
        </div>
        
        <!-- Drag & drop area -->
        <div id="dropzone" class="relative group">
          <textarea 
            id="content" 
            class="w-full p-5 rounded-xl bg-navy-dark border border-gray-800 text-offwhite custom-scrollbar focus:ring-1 focus:ring-orange focus:border-orange transition-all shadow-inset-dark text-base" 
            rows="12" 
            placeholder="Drop your brain here. We'll slice it into viral thread sushi..."></textarea>
          
          <div id="drop-indicator" class="hidden absolute inset-0 bg-navy-accent rounded-xl border-2 border-dashed border-orange flex flex-col items-center justify-center">
            <div class="text-4xl mb-2">📄</div>
            <p class="text-offwhite text-lg font-medium">Drop text file here</p>
            <p class="text-gray-400 text-sm">We'll extract the content for you</p>
          </div>
        </div>
        
        <!-- Stats counter -->
        <div class="flex justify-between mt-2 text-xs">
          <div class="flex items-center">
            <span id="word-count" class="text-xs text-gray-400">0 words</span>
            <!-- Animated pulse circle when approaching 100+ words -->
            <span id="word-milestone" class="hidden ml-2 flex-shrink-0 h-2 w-2 rounded-full bg-green-400 animate-pulse"></span>
          </div>
          <span id="character-count" class="text-xs text-gray-400">0 characters</span>
        </div>
      </div>

      <!-- Two-column grid for settings and options -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <!-- First column: Thread style selection -->
        <div class="glass rounded-xl p-5 shadow-glass">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center space-x-2">
              <div class="h-10 w-10 flex items-center justify-center rounded-full bg-gradient-to-br from-[#1D9BF0] to-[#1A8CD8] shadow-lg">
                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path>
                </svg>
              </div>
              <div>
                <p class="text-sm font-medium text-offwhite">Twitter Thread Generator</p>
                <p class="text-xs text-gray-400">13 tweets max with an engaging hook</p>
              </div>
            </div>
            
            <!-- Fixed Thread Style indicator - no dropdown -->
            <div class="flex items-center gap-2">
              <span class="text-sm font-medium text-orange">Viral Hook Master</span>
              <span class="flex-shrink-0 w-6 text-orange text-lg">🔥</span>
            </div>
          </div>
          
          <!-- Thread length options -->
          <div class="mb-4 p-2 bg-navy-dark/70 border border-gray-800 rounded-lg">
            <p class="text-xs text-gray-400 mb-2 ml-1">Thread Length</p>
            <div class="flex justify-between gap-2">
              <button id="length-5" class="thread-length-btn flex-1 py-2 rounded-md text-sm text-center border border-gray-700 text-gray-300 hover:bg-navy-accent transition-colors">
                5 Tweets
                <span class="block text-xs text-gray-500 mt-0.5">Concise</span>
              </button>
              <button id="length-8" class="thread-length-btn flex-1 py-2 rounded-md text-sm text-center border border-gray-700 text-gray-300 hover:bg-navy-accent transition-colors">
                8 Tweets
                <span class="block text-xs text-gray-500 mt-0.5">Balanced</span>
              </button>
              <button id="length-13" class="thread-length-btn active-length flex-1 py-2 rounded-md text-sm text-center border border-orange/50 bg-navy-accent text-orange hover:bg-navy-accent transition-colors">
                13 Tweets
                <span class="block text-xs text-gray-500 mt-0.5">Complete</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Second column: Fixed Writing Style + Preview -->
        <div class="glass rounded-xl p-5 shadow-glass">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center">
              <p class="text-sm font-medium text-offwhite">Viral Hook Master Style</p>
            </div>
            

          </div>
          
          <!-- Style preview (fixed to Viral Hook Master) -->
          <div id="style-preview" class="flex flex-col gap-2 p-4 rounded-lg bg-navy-dark/70 border border-gray-800 mt-3">
            <div class="flex items-center gap-2">
              <div class="w-8 h-8 rounded-full bg-orange/20 flex items-center justify-center text-lg">🔥</div>
              <div class="text-xs text-gray-300">
                <span class="font-medium text-offwhite">@YourHandle</span> · 2h
              </div>
            </div>
            <p class="text-sm text-offwhite">I discovered the ONE thing every successful business does differently, and it's not what you think. Here's everything you need to know: 👇</p>
            <div class="flex items-center justify-between text-gray-500 text-xs mt-1">
              <div>💬 24</div>
              <div>🔁 158</div>
              <div>❤️ 642</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div class="flex flex-col gap-3 mb-6">
        <button 
          id="refactorBtn" 
          class="w-full py-4 rounded-lg bg-gradient-to-r from-orange to-orange-light text-navy-dark font-bold text-lg transition-all hover:shadow-orange-glow animate-pulse-slow relative overflow-hidden"
        >
          <span class="relative z-10">Cook the Thread</span>
        </button>
        
        <button 
          id="clearBtn" 
          class="py-3 rounded-lg border border-gray-700 text-gray-300 font-medium hover:bg-navy-light transition-all"
        >
          Clear All
        </button>
      </div>

      <!-- Results Section -->
      <div class="mb-6">
        <!-- Loading indicator -->
        <div id="loading" class="glass rounded-xl flex flex-col items-center justify-center py-12 px-6 mb-6 hidden">
          <div class="w-16 h-16 border-t-4 border-orange border-solid rounded-full animate-spin mb-4"></div>
          <p class="text-center text-lg text-offwhite mb-2">Generating your content...</p>
          <p class="text-center text-sm text-gray-400">Wuko is processing your content...</p>
        </div>
        
        <!-- Results output -->
        <div id="results" class="space-y-6">
          <!-- Preview cards will be dynamically inserted here -->
        </div>
        
        <!-- Copy All button - initially hidden -->
        <div id="copy-all-container" class="mt-8 flex justify-center hidden">
          <button 
            id="copyAllBtn" 
            class="px-6 py-3 rounded-lg bg-navy-light border border-orange text-orange font-medium hover:bg-opacity-80 hover:shadow-orange-glow transition-all inline-flex items-center gap-2"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
            </svg>
            Copy Thread
          </button>
        </div>
        
        <!-- Thread preview toggle - initially hidden -->
        <div id="thread-preview-toggle" class="mt-4 text-center hidden">
          <button 
            id="togglePreviewBtn" 
            class="text-sm text-gray-400 hover:text-offwhite transition-colors inline-flex items-center gap-1"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <span>Toggle Thread Preview</span>
          </button>
        </div>
        
        <!-- Thread visual preview - hidden by default -->
        <div id="thread-visual-preview" class="mt-6 bg-black bg-opacity-90 rounded-xl p-6 overflow-hidden hidden transition-all duration-300 shadow-glass border border-gray-800">
          <div class="border-b border-gray-700 pb-4 mb-4">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-xl">🧵</div>
              <div class="flex-1">
                <div class="flex items-center">
                  <span class="font-medium text-white">You</span>
                  <span class="text-gray-400 text-sm ml-1">@yourhandle</span>
                  <span class="text-gray-400 text-sm ml-auto">Just now</span>
                </div>
                <p id="preview-hook-text" class="text-white my-2 text-base">Loading thread preview...</p>
                <div class="flex items-center justify-between text-gray-400 text-sm mt-2">
                  <div class="flex items-center gap-3">
                    <div class="flex items-center gap-1"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none"><path d="M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z" fill="currentColor"></path></svg> 5</div>
                    <div class="flex items-center gap-1"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none"><path d="M23.77 15.67c-.292-.293-.767-.293-1.06 0l-2.22 2.22V7.65c0-2.068-1.683-3.75-3.75-3.75h-5.85c-.414 0-.75.336-.75.75s.336.75.75.75h5.85c1.24 0 2.25 1.01 2.25 2.25v10.24l-2.22-2.22c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l3.5 3.5c.145.147.337.22.53.22s.383-.072.53-.22l3.5-3.5c.294-.292.294-.767 0-1.06zm-10.66 3.28H7.26c-1.24 0-2.25-1.01-2.25-2.25V6.46l2.22 2.22c.148.147.34.22.532.22s.384-.073.53-.22c.293-.293.293-.768 0-1.06l-3.5-3.5c-.293-.294-.768-.294-1.06 0l-3.5 3.5c-.294.292-.294.767 0 1.06s.767.293 1.06 0l2.22-2.22V16.7c0 2.068 1.683 3.75 3.75 3.75h5.85c.414 0 .75-.336.75-.75s-.337-.75-.75-.75z" fill="currentColor"></path></svg> 18</div>
                    <div class="flex items-center gap-1"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none"><path d="M12 21.638h-.014C9.403 21.59 1.95 14.856 1.95 8.478c0-3.064 2.525-5.754 5.403-5.754 2.29 0 3.83 1.58 4.646 2.73.814-1.148 2.354-2.73 4.645-2.73 2.88 0 5.404 2.69 5.404 5.755 0 6.376-7.454 13.11-10.037 13.157H12z" fill="currentColor"></path></svg> 124</div>
                  </div>
                  <div class="flex items-center gap-1"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none"><path d="M17.53 7.47l-5-5c-.293-.293-.768-.293-1.06 0l-5 5c-.294.293-.294.768 0 1.06s.767.294 1.06 0l3.72-3.72V15c0 .414.336.75.75.75s.75-.336.75-.75V4.81l3.72 3.72c.146.147.338.22.53.22s.384-.072.53-.22c.293-.293.293-.767 0-1.06z" fill="currentColor"></path><path d="M19.708 21.944H4.292C3.028 21.944 2 20.916 2 19.652V14c0-.414.336-.75.75-.75s.75.336.75.75v5.652c0 .437.355.792.792.792h15.416c.437 0 .792-.355.792-.792V14c0-.414.336-.75.75-.75s.75.336.75.75v5.652c0 1.264-1.028 2.292-2.292 2.292z" fill="currentColor"></path></svg></div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Thread replies preview -->
          <div id="thread-replies" class="space-y-4 pl-12 relative max-h-[400px] overflow-y-auto custom-scrollbar pr-2">
            <!-- Thread line -->
            <div class="absolute top-0 bottom-0 left-5 w-0.5 bg-gray-700"></div>
            
            <!-- Message to show when loading -->
            <div id="thread-loading" class="text-center py-8">
              <div class="inline-block w-8 h-8 border-2 border-t-orange border-gray-700 rounded-full animate-spin mb-2"></div>
              <p class="text-gray-400 text-sm">Loading thread preview...</p>
            </div>
            
            <!-- Will be populated dynamically with tweets -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Macaque companion -->
  <div class="macaque-container">
    <div id="xp-notification" class="absolute -top-16 right-16 bg-orange/20 text-orange px-3 py-1.5 rounded-full text-xs font-medium shadow-orange-glow transform scale-0 opacity-0 transition-all duration-300">
      +1 Streak 🔥
    </div>
    
    <div id="speech-bubble" class="speech-bubble scale-0 opacity-0 glass border border-orange/10">
      <p id="speech-text" class="text-sm text-offwhite"></p>
    </div>
    
    <div id="unlock-tooltip" class="absolute top-0 right-32 glass rounded-md p-3 transform scale-0 opacity-0 transition-all duration-300 shadow-glass z-30">
      <div class="text-center mb-2">
        <span class="text-xs text-gray-400">New unlock at level</span>
        <span class="text-xl font-semibold text-orange">5</span>
      </div>
      <div class="text-sm text-offwhite">Thread Title Polish Mode</div>
      <div class="text-xs text-gray-400 mt-1">Auto-generate viral headlines</div>
      <div class="w-3 h-3 absolute -right-1.5 top-8 bg-navy-light rotate-45 border-r border-t border-orange/10"></div>
    </div>
    
    <!-- Hot spring container -->
    <div class="relative cursor-pointer" id="macaque-bubble">
      <!-- Hot spring pool -->
      <div class="w-32 h-32 rounded-full bg-navy-accent border border-orange/20 shadow-orange-glow relative overflow-hidden">
        <!-- Water ripples -->
        <div class="absolute inset-x-0 top-1/3 bottom-0 bg-gradient-to-b from-orange/10 to-orange/5">
          <div id="ripple-1" class="absolute w-16 h-16 rounded-full border border-orange/10 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0"></div>
          <div id="ripple-2" class="absolute w-16 h-16 rounded-full border border-orange/10 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0" style="animation-delay: 1.5s"></div>
        </div>
        
        <!-- Steam particles -->
        <div class="absolute inset-0 overflow-hidden">
          <div class="steam-particle absolute w-2 h-2 bg-white opacity-50 blur-sm rounded-full left-1/4 bottom-0"></div>
          <div class="steam-particle absolute w-3 h-3 bg-white opacity-50 blur-sm rounded-full left-1/2 bottom-0" style="animation-delay: 1s"></div>
          <div class="steam-particle absolute w-2 h-2 bg-white opacity-50 blur-sm rounded-full left-3/4 bottom-0" style="animation-delay: 2s"></div>
        </div>
        
        <!-- Replace pixel art with Wuko monkey image -->
        <div class="absolute inset-0 w-full h-full overflow-hidden">
          <!-- Hot spring water base layer -->
          <div class="absolute bottom-0 inset-x-0 h-12" style="background: linear-gradient(to bottom, #86C8EB, #3D9AD1);">
            <!-- Water bubbles -->
            <div class="absolute top-1 left-3 w-1 h-1 bg-white rounded-full opacity-80"></div>
            <div class="absolute top-2 left-5 w-1 h-1 bg-white rounded-full opacity-80"></div>
            <div class="absolute top-1 left-8 w-1 h-1 bg-white rounded-full opacity-80"></div>
            <div class="absolute top-3 left-10 w-1 h-1 bg-white rounded-full opacity-80"></div>
            
            <!-- Steam particles -->
            <div class="absolute -top-6 left-2 w-2 h-2 bg-white opacity-80 animate-steam rounded-full"></div>
            <div class="absolute -top-8 left-7 w-2 h-2 bg-white opacity-80 animate-steam rounded-full" style="animation-delay: 1s;"></div>
            <div class="absolute -top-4 left-12 w-1 h-1 bg-white opacity-80 animate-steam rounded-full" style="animation-delay: 0.5s;"></div>
          </div>
          
          <!-- Wuko monkey image -->
          <div id="macaque" class="absolute bottom-7 left-1/2 transform -translate-x-1/2 z-10">
            <div class="relative w-20 h-20">
              <img 
                src="https://pfst.cf2.poecdn.net/base/image/d5eeb60da99b0f5da5b372b289a1c7b3323b8a790cd0245bb3b5248b87f75ac9?w=1024&h=1024" 
                class="w-full h-full object-cover object-top rounded-t-full animate-bounce-short" 
                alt="Wuko Macaque"
                style="clip-path: inset(0 0 40% 0);"
              >
            </div>
          </div>
        </div>
      </div>
      
      <!-- Wisdom level -->
      <div class="absolute -top-2 -right-2 w-8 h-8 rounded-full bg-gradient-to-br from-orange to-orange-light shadow-orange-glow flex items-center justify-center text-navy-dark text-xs font-bold">
        <span id="level-indicator">1</span>
      </div>
      
      <!-- Experience bar -->
      <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-24 glass rounded-full p-[1px] exp-bar">
        <div id="exp-fill" class="h-1.5 bg-gradient-to-r from-orange to-orange-light rounded-full exp-fill" style="width: 10%;"></div>
      </div>
      
      <!-- Streak counter -->
      <div class="absolute -left-2 -bottom-1 text-xs font-medium flex items-center">
        <span id="streak-count" class="bg-navy-accent px-2 py-0.5 rounded-full border border-orange/20">Day 1</span>
      </div>
    </div>
  </div>
  
  <!-- Confetti animation container for copy success -->
  <div id="confetti-container" class="fixed inset-0 pointer-events-none z-50 hidden">
    <canvas id="confetti-canvas"></canvas>
  </div>

  <script>
    /* 
     * © 2023 Wuko Thread Generator - All Rights Reserved
     * Unauthorized copying, modification, distribution, or use of this code is strictly prohibited.
     * Violators will be prosecuted to the full extent of applicable laws.
     */
    
    // Simple code protection system
    (function() {
      // Remove console warning messages entirely as they're causing formatting issues
      
      // Add copyright watermark
      function addWatermark() {
        const watermark = document.createElement('div');
        watermark.style.cssText = 'position:fixed; bottom:10px; left:10px; font-size:10px; opacity:0.5; color:#FFA500; pointer-events:none; z-index:1000;';
        watermark.innerHTML = '© Wuko ' + new Date().getFullYear() + ' - Protected';
        document.body.appendChild(watermark);
      }
      
      // Add the watermark after DOM is loaded
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', addWatermark);
      } else {
        addWatermark();
      }
      
      // Store a signature of the original code
      window._wukoSignature = "WK" + (function() {
        let hash = 0;
        const s = document.querySelector('script').innerText;
        for(let i = 0; i < s.length; i++) {
          hash = ((hash << 5) - hash) + s.charCodeAt(i);
          hash |= 0;
        }
        return hash.toString(36);
      })();
    })();
    
    document.addEventListener('DOMContentLoaded', () => {
      // Elements
      const contentInput = document.getElementById('content');
      const refactorBtn = document.getElementById('refactorBtn');
      const clearBtn = document.getElementById('clearBtn');
      const loadingEl = document.getElementById('loading');
      const resultsEl = document.getElementById('results');
      const wordCountEl = document.getElementById('word-count');
      const charCountEl = document.getElementById('character-count');
      const copyAllContainer = document.getElementById('copy-all-container');
      const copyAllBtn = document.getElementById('copyAllBtn');
      
      // Add sparkles to the background
      createSparkles();
      
      // Hero text alternating messages
      const heroMessages = [
        "From brain dump to dopamine drip.",
        "Make your essays threadworthy.",
        "The monkey will now thread your thoughts.",
        "Scribbles in. Gold out.",
        "One brain. Infinite reach."
      ];
      
      let currentMessageIndex = 0;
      const heroMessageEl = document.getElementById('hero-message');
      
      setInterval(() => {
        heroMessageEl.classList.remove('typewriter');
        void heroMessageEl.offsetWidth;
        currentMessageIndex = (currentMessageIndex + 1) % heroMessages.length;
        heroMessageEl.textContent = heroMessages[currentMessageIndex];
        heroMessageEl.classList.add('typewriter');
      }, 6000);
      
      // Word and character count
      contentInput.addEventListener('input', updateCounters);
      
      function updateCounters() {
        const text = contentInput.value.trim();
        const wordCount = text ? text.split(/\s+/).length : 0;
        const charCount = text.length;
        
        const isOverLimit = wordCount > 555;
        
        wordCountEl.textContent = `${wordCount} word${wordCount !== 1 ? 's' : ''}`;
        wordCountEl.className = isOverLimit ? 'text-red-500 font-medium' : 'text-xs text-gray-400';
        
        if (isOverLimit) {
          wordCountEl.textContent += ` (limit: 555)`;
        }
        
        charCountEl.textContent = `${charCount} character${charCount !== 1 ? 's' : ''}`;
      }
      
      // Format definitions
      const formats = {
        twitter: {
          id: 'twitter',
          name: 'Twitter Thread',
          icon: '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>',
          prompt: `Transform the following content into a viral Twitter thread using this EXACT format:

IMPORTANT: Your response should ONLY contain the thread itself with no introductory text or explanations about what you're doing. Start immediately with the hook tweet.

FIRST TWEET (HOOK):
- Must be only 1-2 short lines maximum (STRICTLY UNDER 280 CHARACTERS)
- Make an extremely bold claim, create massive curiosity, or share urgent news
- Use numbers, brand names, or strong emotion to capture attention
- End with "Here's everything you need to know:" or "Let me break it down 👇" or "10 lessons I learned:"

BODY TWEETS (MAXIMUM 11 BODY TWEETS):
- MANDATORY FORMAT: Number each tweet with "1/ ", "2/ ", "3/ ", etc. (the number MUST be followed by a forward slash)
- Start with tweet "1/ " and continue sequentially ("2/ ", "3/ ", etc.)
- Each tweet MUST be 280 characters or fewer - NO EXCEPTIONS
- Each tweet should contain only ONE point, ONE visual description, or ONE fact
- Keep extremely clear, punchy, and skimmable - no long blocks of text
- Use line breaks, CAPS for emphasis, and relevant emojis

FINAL TWEET:
- Number this tweet as "13/ " or the appropriate final number (with forward slash)
- MUST be under 280 characters
- Summarize the key takeaway or loop back to the hook
- Add a call-to-action like "Save this thread for later" or "What would you add?"

IMPORTANT FORMATTING RULES:
- DO NOT provide any explanation, commentary, or analysis about the process - deliver ONLY the thread itself
- STRICT LIMIT: Total thread should be exactly 13 tweets maximum (1 hook + maximum 11 body + 1 final)
- Check EACH tweet to ensure it's 280 characters or fewer - this is a hard technical limitation
- REQUIRED: Each tweet must start with its number followed by forward slash (1/, 2/, 3/, etc.)
- If the content needs to be condensed, focus on the most valuable and actionable insights

Make the thread provocative, insight-rich, and impossible to scroll past. Focus on the most counterintuitive or valuable insights. Start with the punchline - don't bury the value.

Content to convert:
`
        },
        linkedin: {
          id: 'linkedin',
          name: 'LinkedIn Post',
          icon: '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>',
          prompt: `Transform the following content into a LinkedIn post. Use a professional tone, include a strong hook, use professional bullet points or numbered lists where appropriate, add line breaks for readability, include 3-5 relevant hashtags at the end, and keep it concise (under 1,300 characters if possible). Focus on value, insights, and professional takeaways. Output ONLY the LinkedIn post with no additional explanation or commentary.

Content to convert:
`
        },
        instagram: {
          id: 'instagram',
          name: 'Instagram Caption',
          icon: '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>',
          prompt: `Convert the following content into an Instagram caption. Make it emotionally engaging, use an informal conversational tone, include relevant emojis throughout, use line breaks for readability, add 5-7 relevant hashtags at the end, and keep it relatively short (under 1,000 characters). Focus on visual storytelling and emotional connection. Output ONLY the Instagram caption with no additional explanation or commentary.

Content to convert:
`
        },
        tiktok: {
          id: 'tiktok',
          name: 'TikTok Script',
          icon: '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/></svg>',
          prompt: `Transform the following content into a TikTok video script. Write it in the first person, make it very conversational, use short sentences, include hooks and pattern interrupts, keep it under 60 seconds when read aloud (approximately 150-200 words), and make it highly engaging for Gen Z and Millennial audiences. Focus on the most attention-grabbing aspects of the content. Output ONLY the TikTok script with no additional explanation or commentary.

Content to convert:
`
        },
        newsletter: {
          id: 'newsletter',
          name: 'Newsletter TL;DR',
          icon: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>',
          prompt: `Transform the following content into a concise email newsletter summary (TL;DR version). Keep it under 300 words, use a clear headline, punchy bullet points for key takeaways, and a brief compelling conclusion. Make it scannable, valuable, and actionable. Focus on the most important information only. Output ONLY the newsletter summary with no additional explanation or commentary.

Content to convert:
`
        }
      };
      
      // Generate a simple, shorter handler ID for this session 
      const handlerId = 'wuko-handler-' + Math.floor(Math.random() * 1000);
      
      // Register handler for bot responses
      window.Poe.registerHandler(handlerId, (result) => {
        // Only log errors, not normal results
        
        try {
          // Guard against undefined responses
          if (!result || !result.responses || result.responses.length === 0) {
            console.error("Invalid response received");
            return;
          }
          
          const msg = result.responses[0];
          
          // Check if context exists
          if (!result.context) {
            console.error("Context missing from response");
            return;
          }
          
          const platformId = result.context.platformId;
          if (!platformId) {
            console.error("platformId missing from context");
            return;
          }
          
          const platform = formats[platformId];
          if (!platform) {
            console.error(`Unknown platform: ${platformId}`);
            return;
          }
          
          const resultEl = document.getElementById(`result-${platformId}`);
          if (!resultEl) {
            console.error(`Could not find result element for platform ${platformId}`);
            return;
          }
          
          const contentEl = resultEl.querySelector('.content');
          const loadingIndicator = resultEl.querySelector('.loading-indicator');
          
          if (!contentEl) {
            console.error(`Could not find content element for platform ${platformId}`);
            return;
          }
          
          if (msg.status === "error") {
            contentEl.innerHTML = `<p class="text-red-400">Error: ${msg.statusText || 'Failed to generate content'}</p>`;
            if (loadingIndicator) loadingIndicator.classList.add('hidden');
          } else if (msg.status === "incomplete") {
            // Show partial content while streaming
            try {
              // Remove the loading indicator when we start getting content
              if (loadingIndicator) loadingIndicator.classList.add('hidden');
              
              // Only update if content exists
              if (msg.content && msg.content.trim() !== '') {
                // Use a DOMParser to safely parse HTML content
                const parser = new DOMParser();
                const parsed = parser.parseFromString(marked.parse(msg.content), 'text/html');
                
                // Get the parsed content and set it safely
                contentEl.innerHTML = parsed.body.innerHTML;
              }
            } catch (e) {
              contentEl.textContent = msg.content || "Processing...";
              console.error('Error parsing content');
            }
          } else if (msg.status === "complete") {
            // Final content - ensure we have content to display
            if (!msg.content) {
              contentEl.innerHTML = `<p class="text-red-400">Error: No content received</p>`;
              console.error("Complete status but no content received");
            } else {
              try {
                // Use a DOMParser to safely parse HTML content
                const parser = new DOMParser();
                const parsed = parser.parseFromString(marked.parse(msg.content), 'text/html');
                
                // Get the parsed content and set it safely
                contentEl.innerHTML = parsed.body.innerHTML;
                
                // Enable copy button
                const copyBtn = resultEl.querySelector('.copy-btn');
                if (copyBtn) {
                  copyBtn.disabled = false;
                  copyBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                  copyBtn.classList.add('hover:bg-navy');
                  copyBtn.classList.add('transition-colors');
                }
                
                // Show Copy All button once at least one result is complete
                copyAllContainer.classList.remove('hidden');
                
                // Update macaque experience
                increaseExperience();
                showRandomMacaqueMessage(true);
              } catch (e) {
                contentEl.textContent = msg.content;
                console.error('Error parsing final content');
              }
            }
            
            // Always hide loading indicator on completion
            if (loadingIndicator) loadingIndicator.classList.add('hidden');
          }
        } catch (err) {
          console.error("Error in response handler");
        }
      });
      
      // Copy to clipboard function
      function copyToClipboard(text, button) {
        navigator.clipboard.writeText(text).then(() => {
          const originalText = button.textContent;
          button.textContent = 'Copied!';
          button.classList.add('bg-green-500', 'bg-opacity-20');
          
          setTimeout(() => {
            button.textContent = originalText;
            button.classList.remove('bg-green-500', 'bg-opacity-20');
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy: ', err);
          button.textContent = 'Failed!';
          button.classList.add('bg-red-500', 'bg-opacity-20');
          
          setTimeout(() => {
            button.textContent = 'Copy';
            button.classList.remove('bg-red-500', 'bg-opacity-20');
          }, 2000);
        });
      }
      
      // Refactor button click handler
      refactorBtn.addEventListener('click', async () => {
        const content = contentInput.value.trim();
        
        if (!content) {
          showMacaqueMessage("I need some content to work with! Paste something in the box.");
          return;
        }
        
        // Check word count limit
        const wordCount = content.split(/\s+/).length;
        if (wordCount > 555) {
          showMacaqueMessage("Whoa! Please keep your content under 555 words. Trim it down a bit and try again.");
          
          // Highlight the word counter in red with animation
          wordCountEl.classList.add('text-red-500', 'font-medium', 'animate-pulse');
          setTimeout(() => {
            wordCountEl.classList.remove('animate-pulse');
          }, 2000);
          
          return;
        }
        
        // Disable the refactor button to prevent multiple clicks
        refactorBtn.disabled = true;
        refactorBtn.classList.add('opacity-70');
        
        try {
          // Clear previous results
          resultsEl.innerHTML = '';
          copyAllContainer.classList.add('hidden');
          
          // Show loading
          loadingEl.classList.remove('hidden');
          
          // Show processing message
          showMacaqueMessage("Working on your content... Give me a moment to soak in this hot spring inspiration!");
          
          // We're only using Twitter thread in this app
          const platformId = 'twitter';
          const platform = formats[platformId];
          
          // Create a simpler, shorter handler ID for this specific request
          const requestId = Math.floor(Math.random() * 1000);
          const platformHandlerId = `handler-${platformId}-${requestId}`;
          
          // Create the result container
          const resultEl = document.createElement('div');
          resultEl.id = `result-${platformId}`;
          resultEl.className = 'glass rounded-xl overflow-hidden';
          
          resultEl.innerHTML = `
            <div class="px-4 py-3 border-b border-gray-800 flex justify-between items-center">
              <div class="flex items-center space-x-2">
                <div class="w-6 h-6 flex items-center justify-center text-offwhite">${platform.icon}</div>
                <h3 class="font-medium text-offwhite">${platform.name}</h3>
              </div>
              <button class="copy-btn px-3 py-1 rounded-md text-xs text-gray-300 border border-gray-700 opacity-50 cursor-not-allowed" disabled>Copy</button>
            </div>
            <div class="relative">
              <div class="loading-indicator absolute inset-0 flex items-center justify-center bg-navy-dark bg-opacity-70 backdrop-blur-sm z-10">
                <div class="w-8 h-8 border-t-2 border-orange border-solid rounded-full animate-spin"></div>
                <div class="ml-3 text-sm text-gray-300">Generating thread...</div>
              </div>
              <div class="content p-4 h-[260px] overflow-y-auto custom-scrollbar whitespace-pre-line text-gray-300"></div>
            </div>
          `;
          
          resultsEl.appendChild(resultEl);
          
          // Set up copy button
          const copyBtn = resultEl.querySelector('.copy-btn');
          copyBtn.addEventListener('click', function() {
            if (this.disabled) return;
            
            const contentEl = resultEl.querySelector('.content');
            const textContent = contentEl.textContent.trim();
            copyToClipboard(textContent, this);
            
            // Macaque reaction
            showMacaqueMessage("Great choice! I think that version will perform really well.");
          });
          
          // Modify prompt based on selected thread length
          let threadLengthPrompt = '';
          if (selectedThreadLength === 5) {
            threadLengthPrompt = `IMPORTANT FORMAT UPDATE: Create a thread with EXACTLY 5 TWEETS TOTAL:
1. First tweet: The hook (unnumbered)
2. THREE body tweets numbered "1/", "2/", "3/" (must include the forward slash)
3. Final tweet numbered "4/" (must be exactly "4/" to complete the numbering sequence)

CRITICAL: The final tweet MUST be numbered "4/" (not "5/"). This is because we count the numbered tweets starting from 1/, not counting the hook.
Make the thread concise but powerful - focus only on the most essential points.
`;
          } else if (selectedThreadLength === 8) {
            threadLengthPrompt = `IMPORTANT FORMAT UPDATE: Create a thread with EXACTLY 8 TWEETS TOTAL:
1. First tweet: The hook (unnumbered)
2. SIX body tweets numbered "1/", "2/", "3/", "4/", "5/", "6/" (must include the forward slash)
3. Final tweet numbered "7/" (must be exactly "7/" to complete the numbering sequence)

CRITICAL: The final tweet MUST be numbered "7/" (not "8/"). This is because we count the numbered tweets starting from 1/, not counting the hook.
Focus on the most valuable insights while maintaining a balanced thread structure.
`;
          } else {
            // Default 13 tweets - use the standard prompt
            threadLengthPrompt = '';
          }
          
          // Prepare the prompt with thread length specification
          const finalPrompt = platform.prompt + threadLengthPrompt + content;
          
          // Manual timeout for safety
          let hasResponded = false;
          const timeoutDuration = 45000; // 45 seconds timeout
          
          const timeoutPromise = new Promise(resolve => {
            setTimeout(() => {
              if (!hasResponded) {
                console.warn(`Request timed out after ${timeoutDuration/1000} seconds`);
                resolve({ timedOut: true });
              }
            }, timeoutDuration);
          });
          
          // First REGISTER the handler, then send the request
          console.log(`[${new Date().toISOString()}] Registering handler ${platformHandlerId}`);
          
          window.Poe.registerHandler(platformHandlerId, (result, ctx) => {
            hasResponded = true;
            console.log(`[${new Date().toISOString()}] Got response:`, result.status);
            
            if (!result || !result.responses || result.responses.length === 0) {
              console.error("Empty response received");
              
              const loadingIndicator = resultEl.querySelector('.loading-indicator');
              const contentEl = resultEl.querySelector('.content');
              
              if (loadingIndicator) loadingIndicator.classList.add('hidden');
              if (contentEl) contentEl.innerHTML = `<p class="text-red-400">Error: No response received from AI</p>`;
              return;
            }
            
            const msg = result.responses[0];
            
            // Handle the response
            const loadingIndicator = resultEl.querySelector('.loading-indicator');
            const contentEl = resultEl.querySelector('.content');
            
            if (msg.status === "error") {
              console.error(`Error response:`, msg.statusText);
              if (contentEl) contentEl.innerHTML = `<p class="text-red-400">Error: ${msg.statusText || 'Failed to generate content'}</p>`;
              if (loadingIndicator) loadingIndicator.classList.add('hidden');
            } else if (msg.status === "incomplete") {
              try {
                // Remove the loading indicator when we start getting content
                if (loadingIndicator) {
                  console.log("Hiding loading indicator as partial content is arriving");
                  loadingIndicator.classList.add('hidden');
                }
                
                // Only update if content exists
                if (msg.content && msg.content.trim() !== '') {
                  if (contentEl) {
                    // Use textContent for debugging but innerHTML for display 
                    console.log(`Streaming content (${msg.content.length} chars)`);
                    contentEl.innerHTML = marked.parse(msg.content);
                  }
                }
              } catch (e) {
                if (contentEl) contentEl.textContent = msg.content || "Processing...";
                console.error(`Error parsing markdown:`, e);
              }
            } else if (msg.status === "complete") {
              console.log(`Complete response received`);
              
              if (!msg.content) {
                console.error(`No content in complete response`);
                if (contentEl) contentEl.innerHTML = `<p class="text-red-400">Error: No content received</p>`;
              } else {
                console.log(`Final content received (${msg.content.length} chars)`);
                try {
                  if (contentEl) {
                    contentEl.innerHTML = marked.parse(msg.content);
                    console.log("Successfully rendered markdown");
                    
                    // Enable copy button
                    if (copyBtn) {
                      copyBtn.disabled = false;
                      copyBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                      copyBtn.classList.add('hover:bg-navy');
                    }
                    
                    // Show Copy All button
                    copyAllContainer.classList.remove('hidden');
                    
                    // Update macaque experience
                    increaseExperience();
                    showRandomMacaqueMessage(true);
                  }
                } catch (e) {
                  if (contentEl) contentEl.textContent = msg.content;
                  console.error(`Error parsing final markdown:`, e);
                }
              }
              
              // Always hide loading indicator on completion
              if (loadingIndicator) loadingIndicator.classList.add('hidden');
            }
          });
          
          // AFTER registering handler, send the request
          try {
            // Use a more browser-friendly approach with proper error handling
            try {
              // Check if Poe API is available
              if (!window.Poe || typeof window.Poe.sendUserMessage !== 'function') {
                throw new Error('Poe API not available. Please try refreshing the page.');
              }
              
              // Use a simpler API call format
              const sendPromise = window.Poe.sendUserMessage(
                `@Claude-3.7-Sonnet ${finalPrompt}`,
                {
                  handler: platformHandlerId,
                  stream: true,
                  openChat: false,
                  handlerContext: { platformId }
                }
              );
              
              // Race between timeout and actual response
              const result = await Promise.race([sendPromise, timeoutPromise]);
              
              if (result && result.timedOut) {
                // Handle timeout case
                const loadingIndicator = resultEl.querySelector('.loading-indicator');
                const contentEl = resultEl.querySelector('.content');
                
                if (loadingIndicator) loadingIndicator.classList.add('hidden');
                if (contentEl) {
                  contentEl.innerHTML = `
                    <div class="text-orange p-4 border border-orange/20 rounded-lg">
                      <p class="font-medium mb-2">Taking longer than expected...</p>
                      <p class="text-sm text-gray-300">The AI is still thinking. You can:</p>
                      <ul class="text-sm text-gray-300 list-disc pl-4 mt-2">
                        <li>Wait a bit longer</li>
                        <li>Try again with shorter content</li>
                        <li>Try refreshing the page</li>
                      </ul>
                    </div>
                  `;
                }
              }
            } catch (poeApiError) {
              // Handle specific Poe API errors
              if (poeApiError.errorType === 'USER_REJECTED_CONFIRMATION') {
                throw new Error('Request was rejected. Please try again.');
              } else if (poeApiError.errorType === 'ANOTHER_CONFIRMATION_IS_OPEN') {
                throw new Error('Another confirmation dialog is open. Please close it and try again.');
              } else if (poeApiError.errorType === 'INVALID_INPUT') {
                throw new Error('Invalid input. Please try again with different content.');
              } else {
                // Generic error handling
                throw poeApiError;
              }
            }
          } catch (err) {
            console.error(`[${new Date().toISOString()}] Error sending request:`, err);
            
            const loadingIndicator = resultEl.querySelector('.loading-indicator');
            const contentEl = resultEl.querySelector('.content');
            
            if (loadingIndicator) loadingIndicator.classList.add('hidden');
            if (contentEl) {
              contentEl.innerHTML = `
                <div class="p-4 border border-red-500/20 rounded-lg bg-red-500/10">
                  <p class="font-medium mb-2 text-red-400">Error</p>
                  <p class="text-sm text-gray-300">${err.message || 'Failed to send request. Please refresh and try again.'}</p>
                  ${err.message && err.message.includes('Google') ? 
                    `<p class="text-sm text-gray-300 mt-2">This might be related to your browser security settings or extensions.</p>` : ''}
                </div>
              `;
            }
          }
          
          // Set a backup timeout to remove loading indicator if nothing happens
          setTimeout(() => {
            if (!hasResponded) {
              const loadingIndicator = resultEl.querySelector('.loading-indicator');
              if (loadingIndicator && !loadingIndicator.classList.contains('hidden')) {
                console.warn("No response after timeout - hiding loading indicator");
                loadingIndicator.classList.add('hidden');
                
                const contentEl = resultEl.querySelector('.content');
                if (contentEl) {
                  contentEl.innerHTML = `
                    <div class="text-orange p-4 border border-orange/20 rounded-lg">
                      <p class="font-medium mb-2">Something went wrong</p>
                      <p class="text-sm text-gray-300">The AI service isn't responding. Please try again in a moment.</p>
                      <button id="retry-btn" class="mt-3 px-3 py-1 bg-orange/20 text-orange rounded-md hover:bg-orange/30 transition-colors">
                        Try Again
                      </button>
                    </div>
                  `;
                  
                  // Add retry button functionality
                  const retryBtn = document.getElementById('retry-btn');
                  if (retryBtn) {
                    retryBtn.addEventListener('click', () => {
                      refactorBtn.click();
                    });
                  }
                }
              }
            }
          }, timeoutDuration + 5000);
          
          // Always hide main loading indicator after a reasonable time
          setTimeout(() => {
            loadingEl.classList.add('hidden');
          }, 3000);
          
        } catch (error) {
          console.error('Error in refactor process:', error);
          
          // Show error state
          const errorHtml = `
            <div class="glass rounded-xl p-5 text-center">
              <p class="text-red-400 mb-3">An error occurred while generating content</p>
              <p class="text-sm text-gray-300 mb-4">${error.message || 'Please try again in a moment'}</p>
              <button id="retry-error-btn" class="px-4 py-2 bg-navy-light border border-orange text-orange rounded-lg hover:bg-navy-accent transition-colors">
                Try Again
              </button>
            </div>
          `;
          
          resultsEl.innerHTML = errorHtml;
          loadingEl.classList.add('hidden');
          
          // Add retry button functionality
          const retryBtn = document.getElementById('retry-error-btn');
          if (retryBtn) {
            retryBtn.addEventListener('click', () => {
              refactorBtn.click();
            });
          }
          
          showMacaqueMessage("Oops! Something went wrong. Let's try that again.");
        } finally {
          // Re-enable the refactor button
          setTimeout(() => {
            refactorBtn.disabled = false;
            refactorBtn.classList.remove('opacity-70');
          }, 2000);
        }
      });
      
      // Copy All button handler
      copyAllBtn.addEventListener('click', () => {
        const allContent = Array.from(document.querySelectorAll('.content'))
          .map(el => {
            const platformId = el.closest('[id^="result-"]').id.replace('result-', '');
            const platform = formats[platformId];
            return `===== ${platform.name} =====\n\n${el.textContent.trim()}\n\n`;
          })
          .join('\n');
        
        navigator.clipboard.writeText(allContent).then(() => {
          copyAllBtn.innerHTML = `
            <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            Copied Thread!
          `;
          
          setTimeout(() => {
            copyAllBtn.innerHTML = `
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
              </svg>
              Copy Thread
            `;
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy all content:', err);
        });
        
        // Macaque dance
        danceMacaque();
        showMacaqueMessage("You're all set! Go share these with the world! 🌎");
      });
      
      // Remove the "Post to X" functionality since the button no longer exists
      // We're just keeping the CSS confetti effects for the "Copy Thread" button
      
      // Function to parse and extract tweets from thread content
      function parseTweetThread(threadText) {
        console.log("Parsing thread text:", threadText.substring(0, 100) + "...");
        
        // First try to split by double newlines, which is how most markdown will be formatted
        let tweets = threadText.split(/\n\n+/);
        console.log("Split by newlines found", tweets.length, "potential tweets");
        
        if (tweets.length <= 1) {
          // If that didn't work, try just looking for numbered tweets format
          const tweetRegex = /(?:^|\n+)(?:\d+\/[\s\S]*?)(?=\n+\d+\/|\n*$)/g;
          const numberedTweets = threadText.match(tweetRegex) || [];
          console.log("Regex found", numberedTweets.length, "numbered tweets");
          
          // Try to find the hook tweet (first part before any numbered tweets)
          const hookRegex = /^((?!\d+\/)[\s\S]*?)(?=\n+\d+\/|\n*$)/;
          const hookMatch = threadText.match(hookRegex);
          const hookTweet = hookMatch ? hookMatch[0].trim() : '';
          
          // Combine hook and numbered tweets
          if (hookTweet) {
            tweets = [hookTweet, ...numberedTweets];
          } else {
            tweets = numberedTweets;
          }
        }
        
        // Filter out empty tweets and trim
        tweets = tweets.map(tweet => tweet.trim()).filter(tweet => tweet.length > 0);
        
        console.log("Final tweet count:", tweets.length);
        return tweets;
      }
      
      // Function to show thread posting instructions
      function showThreadPostingInstructions(tweetCount) {
        // Create modal overlay
        const overlay = document.createElement('div');
        overlay.className = 'fixed inset-0 bg-navy-dark bg-opacity-80 flex items-center justify-center z-50 p-4';
        overlay.style.backdropFilter = 'blur(4px)';
        
        // Create modal content
        overlay.innerHTML = `
          <div class="glass rounded-xl p-6 max-w-md mx-auto shadow-orange-glow animate-expand">
            <div class="text-center mb-4">
              <h3 class="text-xl font-display font-bold text-orange mb-1">Posting Your Thread to X</h3>
              <p class="text-sm text-gray-300">We've opened X with your first tweet</p>
            </div>
            
            <div class="mb-6 p-3 bg-navy-accent/70 rounded-lg border border-orange/20">
              <div class="flex items-center gap-2 mb-2">
                <svg class="w-5 h-5 text-orange" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="font-medium text-orange">Important Note</span>
              </div>
              <p class="text-sm text-gray-300">X requires you to create a thread manually by posting the first tweet and then using their "+" button to add subsequent tweets. We've opened X with your first tweet and copied all tweets to your clipboard for easy access.</p>
            </div>
            
            <div class="space-y-3 text-sm text-gray-200">
              <div class="flex items-start gap-3">
                <div class="w-7 h-7 rounded-full bg-orange/20 flex items-center justify-center text-orange">1</div>
                <div>Post your first tweet by clicking the "Post" button on X.</div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="w-7 h-7 rounded-full bg-orange/20 flex items-center justify-center text-orange">2</div>
                <div>After posting, click the <span class="font-bold">+</span> icon at the bottom of your tweet to add the next tweet in your thread.</div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="w-7 h-7 rounded-full bg-orange/20 flex items-center justify-center text-orange">3</div>
                <div>Paste each subsequent tweet from your clipboard (${tweetCount} total tweets). We've made it easy by copying them all for you!</div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="w-7 h-7 rounded-full bg-orange/20 flex items-center justify-center text-orange">4</div>
                <div>Repeat until your complete thread is posted (start with the hook tweet, then add 1/, 2/, etc.)</div>
              </div>
            </div>
            
            <div class="mt-6 text-center">
              <button id="close-instructions" class="px-5 py-2 bg-orange/20 hover:bg-orange/30 text-orange rounded-lg transition-colors">
                Got it!
              </button>
            </div>
          </div>
        `;
        
        // Add to the document
        document.body.appendChild(overlay);
        
        // Copy the thread to clipboard for easy access
        const twitterContentEl = document.querySelector('#result-twitter .content');
        if (twitterContentEl) {
          navigator.clipboard.writeText(twitterContentEl.textContent.trim()).catch(err => {
            console.error('Failed to copy thread to clipboard:', err);
          });
        }
        
        // Add close handler
        const closeBtn = overlay.querySelector('#close-instructions');
        closeBtn.addEventListener('click', () => {
          overlay.classList.add('opacity-0');
          setTimeout(() => {
            overlay.remove();
          }, 300);
        });
      }
      
      // Clear button click handler
      clearBtn.addEventListener('click', () => {
        contentInput.value = '';
        resultsEl.innerHTML = '';
        copyAllContainer.classList.add('hidden');
        updateCounters();
        showMacaqueMessage("All clean! Ready for your next masterpiece.");
      });
      
      // Custom style prompt
      const customStylePrompt = `Rewrite the following content using this EXACT style:

The Pizza Joint With No Marketing But a Line Around the Block
Start with a storytelling hook or relatable example. Use Title Case for section headings.

Break sentences into their own lines.

Short, powerful sentences only.

No fluff.

Simplify complex ideas with clear, actionable language.

Use metaphors and analogies to make concepts memorable.

Pose rhetorical questions.

Why?

Because questions create engagement.

Add occasional dramatic pauses with ellipses...

Then deliver a powerful insight.

Use numbered points with forward slashes:

1/ The first point should be provocative
A brief explanation that challenges conventional thinking.

2/ The second point builds on the first
Add concrete examples and specific details.

3/ The third point delivers the payoff
The insight that ties everything together.

Include mini case studies or personal experiments for credibility.

Focus on small, incremental changes:

Most people try to change everything at once.

Smart people focus on one tiny habit at a time.

That's how lasting change happens.

Use quotes with attribution to add authority:

"Powerful statement that challenges assumptions." Name of Person

Simple equations make concepts stick:

Problem + Solution = Result

Good writing = Clear thinking on paper

Create sharp contrasts between ideas:

Most people do this.

You should do this instead.

Highlight practical systems and frameworks instead of theory.

Focus on efficiency and productivity as core values.

Challenge conventional wisdom with innovative alternatives.

Use a conversational, relatable tone throughout.

Occasionally use short paragraphs of 2-3 sentences that build rhythm.

Then break the pattern with a single line for emphasis.

This creates impact.

End sections with a question that provokes thought:

What could this mean for your business?

Now rewrite the following content using this EXACT style, format, and structure - make it sound exactly like this:

`;

      // Macaque functionality
      const macaqueBubble = document.getElementById('macaque-bubble');
      const speechBubble = document.getElementById('speech-bubble');
      const speechText = document.getElementById('speech-text');
      const expFill = document.getElementById('exp-fill');
      
      // Experience level
      let expLevel = 1;
      let expPercentage = 10;
      
      function increaseExperience() {
        // Increase by a random amount between 5-15%
        const increase = Math.floor(Math.random() * 11) + 5;
        expPercentage += increase;
        
        if (expPercentage >= 100) {
          expLevel++;
          expPercentage = expPercentage - 100;
          showMacaqueMessage(`🎉 Level up! I'm now level ${expLevel}. My monkey wisdom grows stronger!`);
          
          // Bounce animation for level up
          macaqueBubble.classList.add('animate-bounce');
          setTimeout(() => {
            macaqueBubble.classList.remove('animate-bounce');
          }, 1000);
        }
        
        // Update the experience bar
        expFill.style.width = `${expPercentage}%`;
      }
      
      // Macaque messages
      const macaqueGreetings = [
        "Hot takes come from cold baths, my friend.",
        "I warmed up the wisdom for your next thread.",
        "You write, I soak. Fair deal?",
        "Need viral content? Let's make some monkey business.",
        "Type something. I'll make it internet-famous."
      ];
      
      const macaqueAdvice = [
        "Your tone screams 'burn the ships.' Keep it coming.",
        "Fun fact: Hemingway wrote like this, minus the Twitter.",
        "Short sentences hit harder. Long ones lose impact.",
        "The best threads start with controversy and end with wisdom.",
        "Questions create engagement. Statements just sit there."
      ];
      
      const macaqueResults = [
        "Now that's some spicy content! Should perform well.",
        "The algorithm will feast on this like I feast on bananas.",
        "If this doesn't go viral, I'll eat my invisible hat.",
        "Content so good it makes me want to stop soaking and start typing.",
        "Perfectly refactored! That'll get some engagement for sure."
      ];
      
      // Spicy Macaque Mode messages (more quirky and fun)
      const spicyMacaqueGreetings = [
        "Still waiting... Even my banana turned brown.",
        "Writer's block? That's just your brain playing hard to get.",
        "I could write this faster with my opposable thumbs.",
        "Let me guess, you're overthinking it. Classic human move.",
        "At my typing speed, this would take 3 million years. No pressure."
      ];
      
      const spicyMacaqueAdvice = [
        "This feels like LinkedIn content having an existential crisis.",
        "You're using too many big words. Make it monkey-simple.",
        "That opening line has the energy of a deflated balloon.",
        "Cut 50% of the words. Then cut 25% more. Now we're talking.",
        "Less corporate-speak, more monkey business. Trust me."
      ];
      
      const spicyMacaqueResults = [
        "Thread forged. I soaked up your wisdom and made it hotter.",
        "Is it viral yet? No? Let me throw some more steam on it.",
        "That's thread gold, baby! Even my simian brain is impressed.",
        "If this doesn't get engagement, I'll throw my digital poop at X's servers.",
        "Your thread is ready! *throws towel in air with excitement*"
      ];
      
      // Macaque Mode is always on - removed toggle
      let macaqueModeEnabled = true;
      
      // Show macaque message
      function showMacaqueMessage(message) {
        speechText.textContent = message;
        speechBubble.classList.remove('scale-0', 'opacity-0');
        speechBubble.classList.add('scale-100', 'opacity-100');
        
        // Hide after 5 seconds
        setTimeout(() => {
          speechBubble.classList.remove('scale-100', 'opacity-100');
          speechBubble.classList.add('scale-0', 'opacity-0');
        }, 5000);
      }
      
      // Show random macaque message
      function showRandomMacaqueMessage(isResult = false) {
        let messages;
        
        if (macaqueModeEnabled) {
          // Use spicy messages when Macaque Mode is on
          if (isResult) {
            messages = spicyMacaqueResults;
          } else {
            messages = Math.random() > 0.5 ? spicyMacaqueGreetings : spicyMacaqueAdvice;
          }
        } else {
          // Use regular messages when Macaque Mode is off
          if (isResult) {
            messages = macaqueResults;
          } else {
            messages = Math.random() > 0.5 ? macaqueGreetings : macaqueAdvice;
          }
        }
        
        const randomIndex = Math.floor(Math.random() * messages.length);
        showMacaqueMessage(messages[randomIndex]);
      }
      
      // Initial greeting
      setTimeout(() => {
        showRandomMacaqueMessage();
      }, 1500);
      
      // Click macaque to show message
      macaqueBubble.addEventListener('click', () => {
        showRandomMacaqueMessage();
      });
      
      // Enhanced copy all function
      copyAllBtn.addEventListener('click', () => {
        // Get thread content
        const allContent = Array.from(document.querySelectorAll('.content'))
          .map(el => el.textContent.trim())
          .join('\n\n');
        
        // Copy to clipboard
        navigator.clipboard.writeText(allContent).then(() => {
          // Show success UI
          copyAllBtn.innerHTML = `
            <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            Copied Thread!
          `;
          
          // Launch confetti effect
          showConfetti();
          
          setTimeout(() => {
            copyAllBtn.innerHTML = `
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
              </svg>
              Copy Thread
            `;
          }, 2000);
        });
        
        // Show success message from macaque
        danceMacaque();
        showMacaqueMessage("You're all set! Go share these with the world! 🌎");
        
        // Show thread preview toggle after copying
        document.getElementById('thread-preview-toggle').classList.remove('hidden');
        
        // Update thread preview with current content
        const contentEl = document.querySelector('.content');
        if (contentEl) {
          updateThreadPreview(contentEl.textContent);
        }
      });
      
      // Dance animation for macaque
      function danceMacaque() {
        const macaque = document.getElementById('macaque');
        macaque.classList.add('animate-bounce');
        
        setTimeout(() => {
          macaque.classList.remove('animate-bounce');
        }, 2000);
      }
      
      // Thread Preview Toggle Button functionality
      const togglePreviewBtn = document.getElementById('togglePreviewBtn');
      const threadVisualPreview = document.getElementById('thread-visual-preview');
      
      // Function to update thread preview with tweets
      function updateThreadPreview(threadContent) {
        try {
          // Extract tweets from the thread
          const tweets = parseTweetThread(threadContent);
          
          if (!tweets || tweets.length === 0) {
            // Add a message in the preview area
            document.getElementById('preview-hook-text').textContent = "No thread content found. Please generate a thread first.";
            return;
          }
          
          // Set the hook tweet (first tweet) - sanitize content first
          const hookTweet = tweets[0];
          document.getElementById('preview-hook-text').textContent = hookTweet;
          
          // Clear existing replies
          const threadReplies = document.getElementById('thread-replies');
          threadReplies.innerHTML = '';
          
          // Add the numbered tweets as replies
          for (let i = 1; i < tweets.length; i++) {
            const tweet = tweets[i];
            const tweetEl = document.createElement('div');
            tweetEl.className = 'flex items-start gap-3 mb-4 pb-4 border-b border-gray-800 last:border-b-0';
            
            // Create child elements separately for better security
            const avatarDiv = document.createElement('div');
            avatarDiv.className = 'w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-sm';
            const avatarSpan = document.createElement('span');
            avatarSpan.className = 'text-white';
            avatarSpan.textContent = '👤';
            avatarDiv.appendChild(avatarSpan);
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'flex-1';
            
            const headerDiv = document.createElement('div');
            headerDiv.className = 'flex items-center';
            
            const nameSpan = document.createElement('span');
            nameSpan.className = 'font-medium text-white';
            nameSpan.textContent = 'You';
            
            const handleSpan = document.createElement('span');
            handleSpan.className = 'text-gray-400 text-sm ml-1';
            handleSpan.textContent = '@yourhandle';
            
            const timeSpan = document.createElement('span');
            timeSpan.className = 'text-gray-400 text-sm ml-auto';
            timeSpan.textContent = 'Just now';
            
            headerDiv.appendChild(nameSpan);
            headerDiv.appendChild(handleSpan);
            headerDiv.appendChild(timeSpan);
            
            const tweetContent = document.createElement('p');
            tweetContent.className = 'text-white my-2';
            tweetContent.textContent = tweet;
            
            // Stats
            const statsDiv = document.createElement('div');
            statsDiv.className = 'flex items-center justify-between text-gray-400 text-xs mt-2';
            
            const engagementDiv = document.createElement('div');
            engagementDiv.className = 'flex items-center gap-3';
            
            const comments = document.createElement('div');
            comments.textContent = `💬 ${Math.floor(Math.random() * 10) + 1}`;
            
            const retweets = document.createElement('div');
            retweets.textContent = `🔁 ${Math.floor(Math.random() * 50) + 10}`;
            
            const likes = document.createElement('div');
            likes.textContent = `❤️ ${Math.floor(Math.random() * 100) + 20}`;
            
            engagementDiv.appendChild(comments);
            engagementDiv.appendChild(retweets);
            engagementDiv.appendChild(likes);
            
            statsDiv.appendChild(engagementDiv);
            
            contentDiv.appendChild(headerDiv);
            contentDiv.appendChild(tweetContent);
            contentDiv.appendChild(statsDiv);
            
            tweetEl.appendChild(avatarDiv);
            tweetEl.appendChild(contentDiv);
            
            threadReplies.appendChild(tweetEl);
          }
        } catch (err) {
          // Handle any errors safely
          console.error("Error updating thread preview");
          document.getElementById('preview-hook-text').textContent = "Error displaying thread preview.";
        }
      }
      
      // Toggle Preview button click handler
      togglePreviewBtn.addEventListener('click', () => {
        // Toggle the visibility of the thread preview
        if (threadVisualPreview.classList.contains('hidden')) {
          // Show the preview
          threadVisualPreview.classList.remove('hidden');
          threadVisualPreview.classList.add('animate-slide-up');
          
          // Update the preview content if needed
          const contentEl = document.querySelector('.content');
          if (contentEl && contentEl.textContent) {
            updateThreadPreview(contentEl.textContent);
          }
          
          // Change button text
          togglePreviewBtn.querySelector('span').textContent = 'Hide Thread Preview';
        } else {
          // Hide the preview
          threadVisualPreview.classList.add('hidden');
          
          // Change button text back
          togglePreviewBtn.querySelector('span').textContent = 'Toggle Thread Preview';
        }
      });
      
      // Create UI interactivity
      
      // Fixed style - no dropdown functionality
      const stylePreview = document.getElementById('style-preview');
      
      // Thread length options
      const threadLengthBtns = document.querySelectorAll('.thread-length-btn');
      let selectedThreadLength = 13; // Default length
      
      threadLengthBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // Update active state
          threadLengthBtns.forEach(b => {
            b.classList.remove('active-length', 'bg-navy-accent', 'text-orange', 'border-orange/50');
            b.classList.add('text-gray-300', 'border-gray-700');
          });
          
          btn.classList.add('active-length', 'bg-navy-accent', 'text-orange', 'border-orange/50');
          btn.classList.remove('text-gray-300', 'border-gray-700');
          
          // Update selected length
          const length = parseInt(btn.id.split('-')[1], 10);
          selectedThreadLength = length;
          
          // Update description on Twitter Thread Generator
          const threadDescription = document.querySelector('.glass .flex .flex div p:last-child');
          if (threadDescription) {
            threadDescription.textContent = `${selectedThreadLength} tweets max with an engaging hook`;
          }
          
          showMacaqueMessage(`Thread length set to ${selectedThreadLength} tweets. The perfect size for your ideas!`);
        });
      });
      
      // Style options handlers
      const threadStyleOptions = document.querySelectorAll('#thread-style-dropdown button');
      threadStyleOptions.forEach(option => {
        option.addEventListener('click', () => {
          // Update active style
          threadStyleOptions.forEach(btn => btn.classList.remove('active-style'));
          option.classList.add('active-style');
          
          // Update preview based on selected style
          const style = option.getAttribute('data-style');
          updateStylePreview(style);
          
          // Close dropdown
          threadStyleDropdown.classList.add('hidden');
        });
      });
      
      function updateStylePreview(style) {
        const previewText = document.querySelector('#style-preview p');
        const emoji = document.querySelector('#style-preview .w-8.h-8.rounded-full div');
        
        switch(style) {
          case 'viral':
            previewText.textContent = "I discovered the ONE thing every successful business does differently, and it's not what you think. Here's everything you need to know: 👇";
            emoji.textContent = "🔥";
            break;
          case 'authority':
            previewText.textContent = "After analyzing 50+ case studies, I've identified the key revenue driver that differentiates top-performing businesses. Research thread: 👇";
            emoji.textContent = "👑";
            break;
          case 'story':
            previewText.textContent = "Last year, my business was failing. Then I discovered this one approach that changed everything. A short story about transformation: 👇";
            emoji.textContent = "📚";
            break;
          case 'news':
            previewText.textContent = "BREAKING: New study reveals the single factor that separates successful businesses from failures. Key findings in this thread: 👇";
            emoji.textContent = "📰";
            break;
        }
      }
      
      // Writing style buttons
      const styleButtons = document.querySelectorAll('[data-style]');
      styleButtons.forEach(button => {
        button.addEventListener('click', () => {
          // Remove active class from all buttons
          styleButtons.forEach(btn => {
            btn.classList.remove('active-style-choice');
            btn.classList.remove('border-orange/50');
            btn.classList.add('border-gray-800');
          });
          
          // Add active class to clicked button
          button.classList.add('active-style-choice');
          button.classList.remove('border-gray-800');
          button.classList.add('border-orange/50');
        });
      });
      
      // Paste button functionality
      const pasteBtn = document.getElementById('paste-btn');
      pasteBtn.addEventListener('click', async () => {
        try {
          const text = await navigator.clipboard.readText();
          contentInput.value = text;
          updateCounters();
          // Update glow effect
          document.getElementById('input-glow').classList.add('via-orange/10');
          // Show word milestone if enough words
          checkWordMilestone();
          
          showMacaqueMessage("Pasted! Let's turn this into thread gold.");
        } catch (err) {
          showMacaqueMessage("I couldn't access your clipboard. Try pasting manually.");
        }
      });
      
      // We removed the Inspiration and Example buttons, so this code has been removed
      
      // Drag and drop functionality for content input
      const dropzone = document.getElementById('dropzone');
      const dropIndicator = document.getElementById('drop-indicator');
      
      ['dragenter', 'dragover'].forEach(eventName => {
        dropzone.addEventListener(eventName, (e) => {
          e.preventDefault();
          dropIndicator.classList.remove('hidden');
        });
      });
      
      ['dragleave', 'drop'].forEach(eventName => {
        dropzone.addEventListener(eventName, (e) => {
          e.preventDefault();
          dropIndicator.classList.add('hidden');
        });
      });
      
      dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        
        const file = e.dataTransfer.files[0];
        if (file && file.type === 'text/plain') {
          const reader = new FileReader();
          reader.onload = (event) => {
            contentInput.value = event.target.result;
            updateCounters();
            checkWordMilestone();
            showMacaqueMessage("Text file imported! Ready to transform it.");
          };
          reader.readAsText(file);
        } else {
          showMacaqueMessage("I can only read text files (.txt).");
        }
      });
      
      // Word milestone checker (when approaching 100+ words)
      function checkWordMilestone() {
        const wordCount = contentInput.value.trim().split(/\s+/).length;
        const milestone = document.getElementById('word-milestone');
        
        if (wordCount >= 100) {
          milestone.classList.remove('hidden');
        } else {
          milestone.classList.add('hidden');
        }
      }
      
      // Content input focus effects
      contentInput.addEventListener('focus', () => {
        document.getElementById('input-glow').classList.add('via-orange/10');
      });
      
      contentInput.addEventListener('blur', () => {
        document.getElementById('input-glow').classList.remove('via-orange/10');
      });
      
      // Monkey fact click handler
      const monkeyFact = document.getElementById('monkey-fact');
      const monkeyFacts = [
        "🐒 A macaque once typed Hamlet... took 3 million years. You're better than that!",
        "🐒 Macaques can recognize themselves in mirrors, just like you recognizing good content.",
        "🐒 Japanese macaques take hot spring baths to reduce stress. You should try it!",
        "🐒 Macaques have been observed using tools in the wild, but they can't write viral threads (yet).",
        "🐒 Some macaques live in societies with complex hierarchies - kind of like Twitter.",
        "🐒 Macaques can sprint at up to 35 km/h, almost as fast as your great ideas spread!",
        "🐒 Macaques communicate with over 30 different vocalizations. Humans use 280 characters."
      ];
      
      monkeyFact.addEventListener('click', () => {
        const randomFact = monkeyFacts[Math.floor(Math.random() * monkeyFacts.length)];
        monkeyFact.textContent = randomFact;
        monkeyFact.classList.add('animate-pulse');
        setTimeout(() => {
          monkeyFact.classList.remove('animate-pulse');
        }, 1000);
      });
      
      // Ripple effect for buttons
      function createRippleEffect(button) {
        const ripple = document.createElement('span');
        const rect = button.getBoundingClientRect();
        
        ripple.style.position = 'absolute';
        ripple.style.width = '20px';
        ripple.style.height = '20px';
        ripple.style.borderRadius = '50%';
        ripple.style.backgroundColor = 'rgba(255, 165, 0, 0.3)';
        ripple.style.transform = 'scale(0)';
        ripple.style.left = `${rect.width / 2}px`;
        ripple.style.top = `${rect.height / 2}px`;
        ripple.style.animation = 'ripple 0.6s linear';
        ripple.style.pointerEvents = 'none';
        
        button.style.position = 'relative';
        button.style.overflow = 'hidden';
        
        button.appendChild(ripple);
        
        setTimeout(() => {
          ripple.remove();
        }, 600);
      }
      
      // Macaque animation enhancements
      const ripple1 = document.getElementById('ripple-1');
      const ripple2 = document.getElementById('ripple-2');
      const bananaCount = document.getElementById('banana-count');
      const levelIndicator = document.getElementById('level-indicator');
      const xpNotification = document.getElementById('xp-notification');
      const unlockTooltip = document.getElementById('unlock-tooltip');
      const macaque = document.getElementById('macaque');
      
      // Initialize banana count
      let bananas = 0;
      
      // Create ripple effect in hot spring
      function createHotSpringRipple() {
        ripple1.style.animation = 'ripple 2s linear';
        ripple1.style.opacity = '1';
        
        setTimeout(() => {
          ripple2.style.animation = 'ripple 2s linear';
          ripple2.style.opacity = '1';
        }, 1500);
        
        setTimeout(() => {
          ripple1.style.animation = '';
          ripple1.style.opacity = '0';
          ripple2.style.animation = '';
          ripple2.style.opacity = '0';
        }, 3500);
      }
      
      // Start ripple animation
      createHotSpringRipple();
      setInterval(createHotSpringRipple, 6000);
      
      // Enhanced macaque experience system
      function increaseExperience() {
        // Show XP notification
        xpNotification.textContent = "+1 Streak 🔥";
        xpNotification.classList.remove('scale-0', 'opacity-0');
        xpNotification.classList.add('scale-100', 'opacity-100');
        
        // Increase streak count
        const streakCountEl = document.getElementById('streak-count');
        bananas++;
        streakCountEl.textContent = `Day ${bananas}`;
        
        // Increase by a random amount between 5-15%
        const increase = Math.floor(Math.random() * 11) + 5;
        expPercentage += increase;
        
        if (expPercentage >= 100) {
          expLevel++;
          expPercentage = expPercentage - 100;
          
          // Update level indicator
          levelIndicator.textContent = expLevel;
          
          // Animation for level up
          macaqueBubble.classList.add('animate-bounce');
          
          // Special level-up celebratory message
          showMacaqueMessage(`🎉 Level up! I'm now level ${expLevel}. My monkey wisdom grows stronger!`);
          
          // Display unlock tooltip at certain levels
          if (expLevel === 5) {
            setTimeout(() => {
              unlockTooltip.classList.remove('scale-0', 'opacity-0');
              unlockTooltip.classList.add('scale-100', 'opacity-100');
              
              setTimeout(() => {
                unlockTooltip.classList.remove('scale-100', 'opacity-100');
                unlockTooltip.classList.add('scale-0', 'opacity-0');
              }, 5000);
            }, 1500);
          }
          
          setTimeout(() => {
            macaqueBubble.classList.remove('animate-bounce');
          }, 1000);
        }
        
        // Update the experience bar
        expFill.style.width = `${expPercentage}%`;
        
        // Hide XP notification after a delay
        setTimeout(() => {
          xpNotification.classList.remove('scale-100', 'opacity-100');
          xpNotification.classList.add('scale-0', 'opacity-0');
        }, 2000);
      }
      
      // Create steam particles effect
      function createSteamParticles() {
        const steamContainer = document.getElementById('steam-container');
        
        // Create and animate steam particles
        for (let i = 0; i < 3; i++) {
          const particle = document.createElement('div');
          particle.classList.add('absolute', 'w-3', 'h-3', 'bg-white', 'opacity-30', 'rounded-full', 'blur-sm');
          
          // Position randomly within the container
          const leftPos = 40 + Math.random() * 40; // 40-80%
          particle.style.left = `${leftPos}%`;
          particle.style.bottom = '0';
          particle.style.animation = 'steam 3s ease-in-out';
          particle.style.animationDelay = `${i * 0.5}s`;
          
          steamContainer.appendChild(particle);
          
          // Remove particle after animation completes
          setTimeout(() => {
            particle.remove();
          }, 3000 + i * 500);
        }
      }
      
      // Start steam animation
      setInterval(createSteamParticles, 3000);
      createSteamParticles();
      
      // Confetti animation
      function showConfetti() {
        const confettiContainer = document.getElementById('confetti-container');
        const canvas = document.getElementById('confetti-canvas');
        
        confettiContainer.classList.remove('hidden');
        
        // Set canvas dimensions to match window
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const ctx = canvas.getContext('2d');
        const pieces = [];
        const colors = ['#FFA500', '#FFB733', '#E69500', '#5CD5B0', '#FF5CB8', '#5C9EFF', '#8855FF'];
        
        // Create confetti pieces
        for (let i = 0; i < 100; i++) {
          pieces.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height - canvas.height,
            size: Math.random() * 10 + 5,
            color: colors[Math.floor(Math.random() * colors.length)],
            rotation: Math.random() * 360,
            speed: Math.random() * 3 + 2,
            rotationSpeed: Math.random() * 3 - 1.5
          });
        }
        
        function drawConfetti() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          
          pieces.forEach(piece => {
            ctx.save();
            ctx.translate(piece.x, piece.y);
            ctx.rotate(piece.rotation * Math.PI / 180);
            
            ctx.fillStyle = piece.color;
            ctx.fillRect(-piece.size/2, -piece.size/2, piece.size, piece.size);
            
            ctx.restore();
            
            // Update position
            piece.y += piece.speed;
            piece.rotation += piece.rotationSpeed;
            
            // Reset pieces that fall out of view
            if (piece.y > canvas.height) {
              piece.y = -piece.size;
              piece.x = Math.random() * canvas.width;
            }
          });
          
          requestAnimationFrame(drawConfetti);
        }
        
        const confettiAnimation = requestAnimationFrame(drawConfetti);
        
        // Stop confetti after 3 seconds
        setTimeout(() => {
          cancelAnimationFrame(confettiAnimation);
          confettiContainer.classList.add('hidden');
        }, 3000);
      }
      
      // Create sparkles in background
      function createSparkles() {
        const container = document.getElementById('sparkle-container');
        const containerWidth = window.innerWidth;
        const containerHeight = window.innerHeight;
        
        for (let i = 0; i < 30; i++) {
          const sparkle = document.createElement('div');
          sparkle.classList.add('sparkle');
          
          // Random position
          sparkle.style.left = `${Math.random() * containerWidth}px`;
          sparkle.style.top = `${Math.random() * containerHeight}px`;
          
          // Random delay
          sparkle.style.animationDelay = `${Math.random() * 10}s`;
          
          container.appendChild(sparkle);
        }
      }
    });
  </script>
</body>
</html>

mv index.js index.html

open index.html



